<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        /* Configuration de la page simplifiée */
        @page {
            size: a4 portrait;
            margin: 1.5cm;
        }
        
        body { font-family: Helvetica, Arial, sans-serif; font-size: 10pt; color: #333; }
        
        /* En-tête */
        .invoice-header { border-bottom: 2px solid #2c3e50; padding-bottom: 10px; margin-bottom: 30px; }
        .company-name { font-size: 20pt; font-weight: bold; color: #2c3e50; }
        .document-type { font-size: 18pt; color: #7f8c8d; text-align: right; }

        /* Tableaux d'adresses */
        .address-table { width: 100%; margin-bottom: 30px; }
        .address-box { width: 45%; vertical-align: top; padding: 10px; background-color: #f9f9f9; border: 1px solid #eeeeee; }

        /* Table des produits */
        .items-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        .items-table th { background-color: #2c3e50; color: #ffffff; padding: 8px; text-align: left; font-size: 9pt; }
        .items-table td { padding: 8px; border-bottom: 1px solid #eeeeee; }
        
        /* Totaux */
        .totals-table { width: 250px; float: right; margin-top: 10px; }
        .totals-table td { padding: 4px; text-align: right; }
        .grand-total { font-weight: bold; color: #e74c3c; font-size: 12pt; border-top: 1px solid #2c3e50; }

        .footer { text-align: center; font-size: 8pt; color: #999; margin-top: 50px; }
    </style>
</head>
<body>

    <div class="invoice-header">
        <table style="width: 100%;">
            <tr>
                <td class="company-name">MON ERP UNIVERSEL</td>
                <td class="document-type">FACTURE</td>
            </tr>
        </table>
    </div>

    <table class="address-table">
        <tr>
            <td style="width: 45%; vertical-align: top;">
                <strong>Référence :</strong> {{ order.reference }}<br>
                <strong>Date :</strong> {{ order.created_at|date:"d/m/Y" }}<br>
                <strong>Transport :</strong> {{ order.carrier.name }}
            </td>
            <td style="width: 10%;"></td>
            <td class="address-box">
                <strong>Client :</strong><br>
                {{ order.customer.first_name }} {{ order.customer.last_name }}<br>
                {% if order.customer.is_professional %}<strong>{{ order.customer.company_name }}</strong><br>{% endif %}
                {{ order.billing_address.street_address }}<br>
                {{ order.billing_address.postal_code }} {{ order.billing_address.city }}
            </td>
        </tr>
    </table>

    <table class="items-table">
        <thead>
            <tr>
                <th style="width: 40%;">Désignation</th>
                <th style="width: 20%; text-align: right;">P.U. TTC</th>
                <th style="width: 10%; text-align: center;">Qté</th>
                <th style="width: 10%; text-align: center;">TVA</th>
                <th style="width: 20%; text-align: right;">Total TTC</th>
            </tr>
        </thead>
        <tbody>
            {% for line in order.lines.all %}
            <tr>
                <td>{{ line.product.name }}</td>
                <td style="text-align: right;">{{ line.unit_price_incl_tax }} €</td>
                <td style="text-align: center;">{{ line.quantity }}</td>
                <td style="text-align: center;">{{ line.vat_rate }}%</td>
                <td style="text-align: right;">{{ line.total_line_incl_tax }} €</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div style="width: 100%;">
        <table class="totals-table">
            <tr>
                <td>Total HT :</td>
                <td>{{ totals.total_ht }} €</td>
            </tr>
            <tr>
                <td>Total TVA :</td>
                <td>{{ totals.total_vat }} €</td>
            </tr>
            <tr class="grand-total">
                <td>TOTAL TTC :</td>
                <td>{{ totals.grand_total_ttc }} €</td>
            </tr>
        </table>
    </div>

    <div style="clear: both;"></div>

    <div class="footer">
        <p>Mon ERP Universel - SIRET: 123 456 789 00001 - TVA: FR123456789</p>
        <p>Merci pour votre commande !</p>
    </div>

</body>
</html>